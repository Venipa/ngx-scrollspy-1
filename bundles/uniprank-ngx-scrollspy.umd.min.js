!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@uniprank/ngx-scrollspy",["exports","@angular/core","@angular/common","rxjs","rxjs/operators"],t):t(((e=e||self).uniprank=e.uniprank||{},e.uniprank["ngx-scrollspy"]={}),e.ng.core,e.ng.common,e.rxjs,e.rxjs.operators)}(this,(function(e,t,r,i,l){"use strict";var n;(n=e.ScrollDirectionEnum||(e.ScrollDirectionEnum={})).vertical="vertical",n.horizontal="horizontal";var s="window",o=new t.InjectionToken(null),c=function(){function r(r,n){var o=this;this.doc=r,this._scrollItems={},this._scrollElements={},this._$scrollElementListener={},this._scrollElementListener={},this._onStopListening=new i.Subject,this._resizeEvents=i.fromEvent(window,"resize").pipe(l.auditTime(300),l.takeUntil(this._onStopListening)),this._scrollEvents=i.fromEvent(window,"scroll").pipe(l.auditTime(10),l.takeUntil(this._onStopListening)),this._initScrollElementListener(s,this._generateScrollElement(s,new t.ElementRef(r.documentElement||r.body),e.ScrollDirectionEnum.vertical)),this._resizeEvents.subscribe((function(){return o._windowScroll()})),this._scrollEvents.subscribe((function(){return o._windowScroll()})),this._windowScroll(),null!==n?(this._lookAhead=n.lookAhead,this._activateOnlySetItems=n.activateOnlySetItems,this.attributeType=n.attributeType):(this._lookAhead=!1,this._activateOnlySetItems=!1,this.attributeType="id")}return r.prototype._initScrollElementListener=function(e,t){this._scrollElements[e]=t,this._scrollElementListener[e]=null,this._$scrollElementListener[e]=new i.BehaviorSubject(null)},r.prototype._windowScroll=function(){this.updateScrollElement(s)},r.prototype._generateScrollElement=function(e,t,r,i){return void 0===i&&(i=0),{id:e,elementRef:t,direction:r,offset:i}},r.prototype.setOffset=function(e,t){this._checkScrollElementExists(e),this._scrollElements[e].offset=t},r.prototype.setScrollElement=function(e,t,r,i){void 0===i&&(i=0),this._checkScrollElementNotExists(e),this._initScrollElementListener(e,this._generateScrollElement(e,t,r,i))},r.prototype._checkScrollElementNotExists=function(e){if(null!=this._scrollElements[e])throw new Error("ScrollSpyService: The scroll element with the id ["+e+"] exists.")},r.prototype.checkScrollElementExists=function(e){return null!=this._scrollElements[e]},r.prototype.setItem=function(e,t,r){void 0===r&&(r=s),this._checkItemNotExists(e),this._scrollItems[e]=this._generateScrollObject(e,t,r),this._setDefaultItem(e,r)},r.prototype._checkItemNotExists=function(e){if(null!=this._scrollItems[e])throw new Error("ScrollSpyService: The scroll item with the id ["+e+"] exists.")},r.prototype._generateScrollObject=function(e,t,r){return{id:e,scrollElementId:r,elementRef:t,nativeElement:t.nativeElement}},r.prototype._setDefaultItem=function(e,t){this._lookAhead||null==this._scrollElementListener[t]&&this._setScrollElementListener(t,this._scrollItems[e])},r.prototype._setScrollElementListener=function(e,t){var r=this;this._scrollElementListener[e]=t,setTimeout((function(){return r._$scrollElementListener[e].next(t)}))},r.prototype.changeScrollElement=function(e,t,r,i){void 0===i&&(i=!1),this._checkScrollElementExists(t),this._checkScrollElementExists(r),this._checkItemExists(e);var l=this._scrollItems[e];(l.scrollElementId!==s&&i||l.scrollElementId===s)&&(this._scrollItems[e].scrollElementId=r),this._setDefaultItem(e,r);var n=this._getElementItems(t);n.length>0&&this._setDefaultItem(n[0].id,t)},r.prototype._getElementItems=function(e){var t=[];for(var r in this._scrollItems)if(this._scrollItems.hasOwnProperty(r)){var i=this._scrollItems[r];i.scrollElementId===e&&t.push(i)}return t},r.prototype._checkItemExists=function(e){if(null==this._scrollItems[e])throw new Error("ScrollSpyService: The scroll item with the id ["+e+"] doesn't exist.")},r.prototype.observe=function(e){return void 0===e&&(e=s),this._checkScrollElementExists(e),this._$scrollElementListener[e].asObservable()},r.prototype._checkScrollElementExists=function(e){if(null==this._scrollElements[e])throw new Error("ScrollSpyService: The scroll element with the id ["+e+"] doesn't exist.")},r.prototype.updateScrollElement=function(e){this._checkScrollElementExists(e);var t=this._scrollElements[e],r=this._getElementItems(e),i=this._getActiveItem(t,r),l=this._scrollElementListener[e];null==l?null!=i&&this._setScrollElementListener(e,i):null!=i?l.id!==i.id&&this._setScrollElementListener(e,i):null==i&&this._lookAhead&&this._setScrollElementListener(e,null)},r.prototype._getActiveItem=function(t,r){var i=this,l=t.direction,n=null,s=t.elementRef.nativeElement;return r.forEach((function(r){var o=!1;switch(l){case e.ScrollDirectionEnum.horizontal:var c="window"===t.id.toLowerCase()?window&&window.pageXOffset||0:s.scrollLeft;o=r.nativeElement.offsetLeft<=c+t.offset;break;default:var h="window"===t.id.toLowerCase()?window&&window.pageYOffset||0:s.scrollTop;o=i._activateOnlySetItems?r.nativeElement.offsetTop<h+t.offset&&r.nativeElement.offsetTop+r.nativeElement.offsetHeight>h+t.offset:r.nativeElement.offsetTop<=h+t.offset}o&&(n=r)})),n},r.prototype.deleteScrollElement=function(e){"window"===e?this._setScrollElementListener(e,null):(this._checkScrollElementExists(e),delete this._scrollElements[e],delete this._$scrollElementListener[e],delete this._scrollElementListener[e])},r.prototype.deleteItem=function(e){null!=this._scrollItems[e]&&delete this._scrollItems[e]},r}();c.decorators=[{type:t.Injectable}],c.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]},{type:void 0,decorators:[{type:t.Inject,args:[o]},{type:t.Optional}]}]};var h=function(){function e(e,t,r){this._el=e,this._scrollSpyService=t,this._cdr=r,this.classActive=!1,this.scrollElement="window"}return e.prototype.ngOnDestroy=function(){this._subscriber&&this._subscriber.unsubscribe(),this._scrollSpyService.deleteItem(this.itemId)},e.prototype.ngAfterViewInit=function(){var e=this;this._subscriber=this._scrollSpyService.observe(this.scrollElement).subscribe((function(t){if(null!=t){var r=t.id===e.itemId;setTimeout((function(){e.classActive=r,e._cdr.markForCheck()}))}})),this._scrollSpyService.setItem(this.itemId,this._el,this.scrollElement);var t="id";"data-id"===this._scrollSpyService.attributeType&&(t="data-id"),this._el.nativeElement.setAttribute(t,this.itemId)},e}();h.decorators=[{type:t.Directive,args:[{selector:"[uniScrollSpy]"}]}],h.ctorParameters=function(){return[{type:t.ElementRef},{type:c},{type:t.ChangeDetectorRef}]},h.propDecorators={classActive:[{type:t.HostBinding,args:["class.active"]}],itemId:[{type:t.Input,args:["uniScrollSpy"]}],scrollElement:[{type:t.Input}]};var u=function(){function t(t,r){this._el=t,this._scrollSpyService=r,this._destroy$=new i.Subject,this.direction=e.ScrollDirectionEnum.vertical,this.destroyElementsSubscription=!0}return t.prototype.onScroll=function(e){this._scrollSpyService.updateScrollElement(this.elementId)},t.prototype.ngOnInit=function(){!this.destroyElementsSubscription&&this._scrollSpyService.checkScrollElementExists(this.elementId)||this._scrollSpyService.setScrollElement(this.elementId,this._el,this.direction),"id"===this._scrollSpyService.attributeType?this._el.nativeElement.setAttribute("id",this.elementId):this._el.nativeElement.setAttribute("data-id",this.elementId)},t.prototype.ngAfterViewInit=function(){var e=this;this._scrollSpyElements.changes.pipe(l.debounceTime(10),l.takeUntil(this._destroy$)).subscribe((function(t){t.length>0&&t.forEach((function(t){e._scrollSpyService.changeScrollElement(t.itemId,t.scrollElement,e.elementId,!0)}))}))},t.prototype.ngOnDestroy=function(){this.destroyElementsSubscription&&this._scrollSpyService.deleteScrollElement(this.elementId),this._destroy$.next()},t}();u.decorators=[{type:t.Directive,args:[{selector:"[uniScrollElement]"}]}],u.ctorParameters=function(){return[{type:t.ElementRef},{type:c}]},u.propDecorators={elementId:[{type:t.Input,args:["uniScrollElement"]}],direction:[{type:t.Input}],destroyElementsSubscription:[{type:t.Input}],_scrollSpyElements:[{type:t.ContentChildren,args:[h,{descendants:!0}]}],onScroll:[{type:t.HostListener,args:["scroll",["$event"]]}]};var a=function(){function e(e,r){this._scrollSpyService=e,this._cdr=r,this.classActive=!1,this.scrollElement="window",this.activeEvent=new t.EventEmitter}return e.prototype.ngOnDestroy=function(){this._subscriber&&this._subscriber.unsubscribe()},e.prototype.ngAfterViewInit=function(){var e=this;this._subscriber=this._scrollSpyService.observe(this.scrollElement).subscribe((function(t){var r;null!=t?(r=t.id===e.itemId,e.activeEvent.emit(r)):r=!1,setTimeout((function(){e.classActive=r,e._cdr.markForCheck()}))}))},e}();a.decorators=[{type:t.Directive,args:[{selector:"[uniScrollItem]"}]}],a.ctorParameters=function(){return[{type:c},{type:t.ChangeDetectorRef}]},a.propDecorators={classActive:[{type:t.HostBinding,args:["class.active"]}],itemId:[{type:t.Input,args:["uniScrollItem"]}],scrollElement:[{type:t.Input}],activeEvent:[{type:t.Output}]};Object.create;function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,l,n=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(e){l={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return s}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}Object.create;var d=[h,a,u],f=[],E=[c],_=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t={lookAhead:!1}),{ngModule:e,providers:p(E,[{provide:o,useValue:t}])}},e}();_.decorators=[{type:t.NgModule,args:[{imports:[r.CommonModule],declarations:p(d,f),exports:p(d,f)}]}],e.NgxScrollspyModule=_,e.ScrollElementDirective=u,e.ScrollItemDirective=a,e.ScrollSpyDirective=h,e.ScrollSpyService=c,e.Éµa=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=uniprank-ngx-scrollspy.umd.min.js.map